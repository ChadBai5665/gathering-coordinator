计划要点总结：

  1. 项目目录 → D:\AICoding\Ontheway，pnpm monorepo（shared / server / web / miniprogram）
  2. 技术栈 → React + Vite + Tailwind（Web）、Supabase（BaaS 全家桶）、原生微信小程序
  3. Supabase 简化 → Auth 替代自建认证、Realtime 替代自建轮询（Web 端）、PostgreSQL 替代 Neon
  4. 5 个 Phase → 基础设施(2天) → 后端(4-5天) → Web(5-6天) → 小程序(5-6天) → 打磨(3-4天)，总计约 4-5 周
  5. ⚠️ 立即行动项 → 注册小程序账号（建议企业主体）+ 启动 ICP 域名备案（约 1-3 周）
  6. Logo → screenshot-20260210-231213.png 重命名为 assets/logo.png
  7. 设计规范 → 主色 #f2930d、字体 Plus Jakarta Sans、Material Icons、完整暗色模式

─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Ready to code?

 Here is Claude's plan:
╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌
 碰个头（OnTheWay）— 全平台重构计划

 Context

 为什么做这个变更：
 现有 gathering-coordinator 项目是一个 Vanilla JS + Express 的 Web 单端应用，功能完整但架构无法支撑多端扩展。需要彻底重构为 Web + 微信小程序 + 未来 APP
 的多端产品，统一后端、统一用户体系、统一设计语言。

 触发原因： 产品从 Web 原型验证阶段进入多端扩展阶段。

 预期结果： 一套后端 API + Web 前端 + 微信小程序，共享设计系统和业务逻辑，支撑 10 万以内用户峰值。

 ---
 一、项目基本信息

 - 项目名称： 碰个头（OnTheWay）
 - 项目目录： D:\AICoding\Ontheway
 - 原项目： D:\AICoding\Chad.OPC\chad-claude-hub\projects\gathering-coordinator（保留不动）
 - Logo： screenshot-20260210-231213.png → 重命名为 assets/logo.png
 - 项目管理： Superpowers 分步开发（Phase → Task → Step，TDD 驱动）
 - 开发节奏： Phase 内按 Task 推进，每个 Task 完成后可验证

 ---
 二、用户确认的技术选型

 - Web 前端： React 18 + Vite ✅
 - 数据库/BaaS： Supabase（PostgreSQL + Auth + Realtime） ✅
 - 小程序账号： 还没有，需要注册（建议企业/个体工商户主体） ⚠️
 - ICP 备案域名： 需确认（小程序上线前必须） ⚠️

 ---
 三、技术架构

 3.1 技术选型总表
 ┌──────────┬──────────────────────────────────────────────┬───────────────────────────────────────────────┐
 │   层级   │                     技术                     │                     理由                      │
 ├──────────┼──────────────────────────────────────────────┼───────────────────────────────────────────────┤
 │ Monorepo │ pnpm workspace                               │ 共享代码、统一依赖                            │
 ├──────────┼──────────────────────────────────────────────┼───────────────────────────────────────────────┤
 │ 语言     │ TypeScript 全栈                              │ 类型安全、前后端共享类型                      │
 ├──────────┼──────────────────────────────────────────────┼───────────────────────────────────────────────┤
 │ Web 前端 │ React 18 + Vite                              │ 组件化、生态成熟                              │
 ├──────────┼──────────────────────────────────────────────┼───────────────────────────────────────────────┤
 │ 样式     │ Tailwind CSS                                 │ 与设计稿一致、暗色模式                        │
 ├──────────┼──────────────────────────────────────────────┼───────────────────────────────────────────────┤
 │ 状态管理 │ Zustand                                      │ 轻量、TS 友好                                 │
 ├──────────┼──────────────────────────────────────────────┼───────────────────────────────────────────────┤
 │ 后端     │ Express + TypeScript                         │ 原项目基础、Vercel 兼容                       │
 ├──────────┼──────────────────────────────────────────────┼───────────────────────────────────────────────┤
 │ BaaS     │ Supabase                                     │ PostgreSQL + Auth + Realtime + Storage 全家桶 │
 ├──────────┼──────────────────────────────────────────────┼───────────────────────────────────────────────┤
 │ 认证     │ Supabase Auth（Web）+ 微信登录桥接（小程序） │ Web 匿名/OAuth，小程序 wx.login 桥接          │
 ├──────────┼──────────────────────────────────────────────┼───────────────────────────────────────────────┤
 │ 实时通信 │ Supabase Realtime（Web）+ 轮询（小程序）     │ Web 直接订阅 DB 变更，小程序轮询              │
 ├──────────┼──────────────────────────────────────────────┼───────────────────────────────────────────────┤
 │ 测试     │ Vitest + Testing Library                     │ Vite 原生                                     │
 ├──────────┼──────────────────────────────────────────────┼───────────────────────────────────────────────┤
 │ 小程序   │ 原生微信 + TypeScript                        │ 性能最优，未来可迁 Taro                       │
 ├──────────┼──────────────────────────────────────────────┼───────────────────────────────────────────────┤
 │ 地图     │ 高德 JS API 2.0（Web）+ wx.map（小程序）     │ 原项目基础                                    │
 ├──────────┼──────────────────────────────────────────────┼───────────────────────────────────────────────┤
 │ 部署     │ Vercel（Web + API）+ Supabase Cloud          │ 免运维                                        │
 └──────────┴──────────────────────────────────────────────┴───────────────────────────────────────────────┘
 3.2 Supabase 带来的架构简化
 ┌──────────────────────────┬───────────────────────────────────────┬──────────┐
 │      原方案（自建）      │             Supabase 方案             │   节省   │
 ├──────────────────────────┼───────────────────────────────────────┼──────────┤
 │ 自建 JWT + 用户表 + 迁移 │ Supabase Auth + auth.users            │ ~300 行  │
 ├──────────────────────────┼───────────────────────────────────────┼──────────┤
 │ 自建轮询 + 版本号机制    │ Supabase Realtime（Postgres Changes） │ ~150 行  │
 ├──────────────────────────┼───────────────────────────────────────┼──────────┤
 │ Drizzle ORM + Neon 配置  │ Supabase Client + 自动类型生成        │ 配置简化 │
 ├──────────────────────────┼───────────────────────────────────────┼──────────┤
 │ 无文件存储               │ Supabase Storage（头像/图片）         │ 免费 1GB │
 └──────────────────────────┴───────────────────────────────────────┴──────────┘
 3.3 认证架构

 Web 端（两种方式）:
   游客: Supabase signInAnonymously() → 匿名用户 → 可升级绑定
   微信: 后续加微信扫码 OAuth（需微信开放平台）

 小程序端:
   wx.login() → code
     → 后端 POST /api/auth/wechat { code }
       → 微信 code2session → openid
       → Supabase admin 查找/创建用户
       → 返回 Supabase session
     → 小程序存储 token

 3.4 数据模型（Supabase PostgreSQL）

 auth.users (Supabase 内置)     profiles (自建，1:1 关联 auth.users)
 ├── id (UUID)                  ├── id (FK → auth.users.id)
 ├── email                      ├── nickname
 ├── created_at                 ├── avatar_url
 └── ...                        ├── wx_openid (唯一索引)
                                └── preferences (JSONB)

 gatherings                     participants
 ├── id (UUID, PK)              ├── id (UUID, PK)
 ├── code (CHAR(6), UQ)         ├── gathering_id (FK)
 ├── name                       ├── user_id (FK → auth.users.id, 可空=游客)
 ├── target_time                ├── nickname
 ├── status (enum)              ├── location (JSONB: {lng, lat})
 ├── creator_id (FK)            ├── location_name
 ├── created_at                 ├── tastes (TEXT[])
 ├── updated_at                 ├── status (enum: joined/departed/arrived)
 └── version (INT, 轮询用)      ├── departure_time
                                ├── travel_duration
 restaurants                    ├── departed_at
 ├── id (UUID, PK)              ├── arrived_at
 ├── gathering_id (FK)          └── reminders_sent (JSONB)
 ├── amap_id
 ├── name / type / address      votes
 ├── location (JSONB)           ├── id (UUID, PK)
 ├── rating / cost              ├── gathering_id (FK)
 ├── score                      ├── restaurant_index
 ├── travel_infos (JSONB)       ├── proposer_id (FK)
 ├── is_confirmed (BOOL)        ├── status (enum: active/passed/rejected)
 └── created_at                 ├── timeout_at
                                └── created_at
 messages
 ├── id (UUID, PK)              vote_records
 ├── gathering_id (FK)          ├── id (UUID, PK)
 ├── type (enum)                ├── vote_id (FK)
 ├── text                       ├── user_id (FK)
 ├── target_id                  ├── agree (BOOL)
 └── created_at                 └── created_at

 ---
 四、项目目录架构

 D:\AICoding\Ontheway\
 ├── CLAUDE.md                          # Claude 协作规范
 ├── README.md                          # 项目总览
 ├── package.json                       # Monorepo 根配置
 ├── pnpm-workspace.yaml
 ├── .gitignore
 ├── .env.example
 │
 ├── assets/                            # 品牌资源
 │   └── logo.png                       # 主 Logo（重命名自 screenshot-*.png）
 │
 ├── docs/                              # 文档
 │   ├── PRD.md                         # 产品需求文档
 │   ├── architecture.md                # 技术架构
 │   ├── api-spec.md                    # API 接口规范
 │   ├── data-model.md                  # 数据模型
 │   ├── design-system.md               # 设计系统（色彩/字体/组件）
 │   └── plans/                         # 分步计划
 │       ├── overview.md
 │       ├── phase-1-foundation.md
 │       ├── phase-2-backend.md
 │       ├── phase-3-web.md
 │       ├── phase-4-miniprogram.md
 │       └── phase-5-polish.md
 │
 ├── packages/
 │   ├── shared/                        # 共享代码（类型/常量/工具）
 │   │   ├── package.json
 │   │   ├── tsconfig.json
 │   │   └── src/
 │   │       ├── constants/             # 状态枚举、口味选项、错误码
 │   │       ├── types/                 # TS 类型定义
 │   │       ├── utils/                 # 纯函数（时间/验证/地理/邀请码）
 │   │       └── index.ts
 │   │
 │   ├── server/                        # 后端（Express + Supabase）
 │   │   ├── package.json
 │   │   ├── tsconfig.json
 │   │   ├── vitest.config.ts
 │   │   └── src/
 │   │       ├── index.ts / app.ts
 │   │       ├── config/
 │   │       ├── middleware/            # auth / error-handler / rate-limiter
 │   │       ├── routes/                # auth / gathering / participant / vote
 │   │       ├── controllers/
 │   │       ├── services/              # 业务逻辑（含迁移的高德/推荐/催促）
 │   │       ├── lib/                   # supabase client 初始化
 │   │       └── utils/
 │   │
 │   ├── web/                           # Web 前端（React + Vite + Tailwind）
 │   │   ├── package.json
 │   │   ├── vite.config.ts
 │   │   ├── tailwind.config.ts
 │   │   ├── index.html
 │   │   └── src/
 │   │       ├── main.tsx / App.tsx
 │   │       ├── styles/
 │   │       ├── components/            # ui/ layout/ gathering/ dashboard/ map/
 │   │       ├── pages/                 # login / home / dashboard / my-gatherings
 │   │       ├── hooks/
 │   │       ├── stores/                # Zustand
 │   │       ├── services/              # API + Supabase client
 │   │       └── router/
 │   │
 │   └── miniprogram/                   # 微信小程序（原生 + TS）
 │       ├── project.config.json
 │       ├── app.json / app.ts / app.wxss
 │       ├── utils/
 │       ├── services/
 │       ├── components/
 │       └── pages/
 │
 ├── design/                            # 设计资源
 │   ├── design-tokens.json
 │   └── web/scheme-a/dashboard.html    # 设计稿参考
 │
 ├── scripts/                           # 工具脚本
 │   └── setup.sh
 │
 └── supabase/                          # Supabase 本地开发配置
     ├── config.toml
     ├── migrations/                    # SQL 迁移文件
     └── seed.sql                       # 种子数据

 ---
 五、从原项目复制的文件
 ┌──────────────────────────────────────┬──────────────┬───────────────────────────────────────────────────────────┐
 │              原文件路径              │     用途     │                           目标                            │
 ├──────────────────────────────────────┼──────────────┼───────────────────────────────────────────────────────────┤
 │ server/services/amap.js              │ 高德地图 API │ → packages/server/src/services/amap.service.ts（JS→TS）   │
 ├──────────────────────────────────────┼──────────────┼───────────────────────────────────────────────────────────┤
 │ server/services/restaurant-picker.js │ 推荐算法     │ → packages/server/src/services/restaurant.service.ts      │
 ├──────────────────────────────────────┼──────────────┼───────────────────────────────────────────────────────────┤
 │ server/services/time-calculator.js   │ 出发时间     │ → packages/server/src/services/time-calculator.service.ts │
 ├──────────────────────────────────────┼──────────────┼───────────────────────────────────────────────────────────┤
 │ server/services/reminder.js          │ 催促模板     │ → packages/server/src/services/reminder.service.ts        │
 ├──────────────────────────────────────┼──────────────┼───────────────────────────────────────────────────────────┤
 │ design/web/scheme-a/dashboard.html   │ UI 参考      │ → design/web/scheme-a/dashboard.html                      │
 └──────────────────────────────────────┴──────────────┴───────────────────────────────────────────────────────────┘
 ---
 六、分步开发计划

 Phase 1: 项目基础设施（2 天）

 目标： Monorepo 骨架 + shared 包 + 文档体系 + Supabase 项目
 ┌───────────────────────┬───────────────────────────────────────────────────────────────┬────────────────────────────────┐
 │         Task          │                             内容                              │            验证标准            │
 ├───────────────────────┼───────────────────────────────────────────────────────────────┼────────────────────────────────┤
 │ 1.1 项目初始化        │ 目录结构、pnpm workspace、tsconfig、.gitignore、logo 重命名   │ pnpm install 成功              │
 ├───────────────────────┼───────────────────────────────────────────────────────────────┼────────────────────────────────┤
 │ 1.2 Supabase 项目创建 │ 创建 Supabase 项目、配置本地开发、环境变量                    │ supabase status 正常           │
 ├───────────────────────┼───────────────────────────────────────────────────────────────┼────────────────────────────────┤
 │ 1.3 shared 包         │ 类型定义、常量、工具函数 + 单元测试                           │ pnpm --filter shared test 通过 │
 ├───────────────────────┼───────────────────────────────────────────────────────────────┼────────────────────────────────┤
 │ 1.4 文档体系          │ CLAUDE.md、README、PRD、architecture、design-system、api-spec │ 文档结构完整                   │
 ├───────────────────────┼───────────────────────────────────────────────────────────────┼────────────────────────────────┤
 │ 1.5 设计 Token        │ design-tokens.json（色彩/字体/间距/圆角规范）                 │ Token 文件可被 Tailwind 引用   │
 └───────────────────────┴───────────────────────────────────────────────────────────────┴────────────────────────────────┘
 ---
 Phase 2: 后端核心服务（4-5 天）

 目标： 统一后端 API，用户认证 + 聚会全流程
 ┌───────────────────┬──────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────────────────────┐
 │       Task        │                                             内容                                             │             验证标准             │
 ├───────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────┼──────────────────────────────────┤
 │ 2.1 数据库 Schema │ Supabase 迁移文件：profiles/gatherings/participants/restaurants/votes/messages 表 + RLS 策略 │ 迁移执行成功，表结构正确         │
 ├───────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────┼──────────────────────────────────┤
 │ 2.2 Express 骨架  │ app.ts、路由注册、错误处理中间件、Supabase client 初始化                                     │ 服务启动，健康检查通过           │
 ├───────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────┼──────────────────────────────────┤
 │ 2.3 认证服务      │ 游客登录 POST /api/auth/guest、微信登录 POST /api/auth/wechat、认证中间件                    │ 游客可获取 token，中间件正确解析 │
 ├───────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────┼──────────────────────────────────┤
 │ 2.4 聚会 CRUD     │ 创建/获取/我的聚会列表、加入聚会                                                             │ API 集成测试通过                 │
 ├───────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────┼──────────────────────────────────┤
 │ 2.5 推荐+投票     │ 迁移高德服务、推荐算法、投票逻辑、出发时间计算                                               │ 完整流程 curl 走通               │
 ├───────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────┼──────────────────────────────────┤
 │ 2.6 轮询+催促     │ GET /api/gatherings/:code/poll、催促引擎（Vercel Cron 或 setInterval）                       │ 轮询返回正确数据，催促消息生成   │
 └───────────────────┴──────────────────────────────────────────────────────────────────────────────────────────────┴──────────────────────────────────┘
 Phase 2 总验证： Postman 完整走通：注册 → 创建 → 加入 → 推荐 → 投票 → 出发 → 到达

 ---
 Phase 3: Web 前端重构（5-6 天）

 目标： 基于设计稿的全新 Web 前端
 ┌───────────────┬───────────────────────────────────────────────────────────────────────────────────────────┬───────────────────┐
 │     Task      │                                           内容                                            │     验证标准      │
 ├───────────────┼───────────────────────────────────────────────────────────────────────────────────────────┼───────────────────┤
 │ 3.1 项目搭建  │ Vite + React + Tailwind 主题（#f2930d / teal / 暗色）+ Router + Zustand + Supabase client │ 空页面可访问      │
 ├───────────────┼───────────────────────────────────────────────────────────────────────────────────────────┼───────────────────┤
 │ 3.2 UI 组件库 │ Button/Card/Input/Toast/Tag/Avatar/Badge/Modal/Loading                                    │ 组件 demo 页正常  │
 ├───────────────┼───────────────────────────────────────────────────────────────────────────────────────────┼───────────────────┤
 │ 3.3 登录页    │ 游客快速进入 + 可选登录、useAuth hook、路由守卫                                           │ 游客/登录流程通过 │
 ├───────────────┼───────────────────────────────────────────────────────────────────────────────────────────┼───────────────────┤
 │ 3.4 首页      │ 创建聚会 + 加入聚会（邀请码/地图选点/口味标签）                                           │ 创建+加入流程通过 │
 ├───────────────┼───────────────────────────────────────────────────────────────────────────────────────────┼───────────────────┤
 │ 3.5 仪表盘    │ 左侧栏（信息/参与者）+ 右侧（推荐卡片/地图/投票/消息流/出发操作）+ Supabase Realtime 订阅 │ 实时同步正常      │
 ├───────────────┼───────────────────────────────────────────────────────────────────────────────────────────┼───────────────────┤
 │ 3.6 我的聚会  │ 聚会历史列表、状态筛选                                                                    │ 列表正确展示      │
 ├───────────────┼───────────────────────────────────────────────────────────────────────────────────────────┼───────────────────┤
 │ 3.7 响应式    │ 移动端侧栏折叠、平板收窄、桌面完整                                                        │ 三种尺寸正常      │
 └───────────────┴───────────────────────────────────────────────────────────────────────────────────────────┴───────────────────┘
 Phase 3 总验证： Chrome/Safari 完整用户流程 + 移动端响应式 + 暗色模式

 ---
 Phase 4: 微信小程序（5-6 天）

 前置条件： 小程序账号已注册、ICP 备案域名已就绪
 ┌───────────────────────┬────────────────────────────────────────────────────────────────────┬──────────────────────────┐
 │         Task          │                                内容                                │         验证标准         │
 ├───────────────────────┼────────────────────────────────────────────────────────────────────┼──────────────────────────┤
 │ 4.1 项目搭建          │ 小程序初始化、TS 配置、API client、全局样式（统一设计 Token）      │ 开发者工具预览正常       │
 ├───────────────────────┼────────────────────────────────────────────────────────────────────┼──────────────────────────┤
 │ 4.2 登录+首页         │ wx.login 认证、创建/加入聚会、wx.chooseLocation 选点、口味选择     │ 创建+加入流程通过        │
 ├───────────────────────┼────────────────────────────────────────────────────────────────────┼──────────────────────────┤
 │ 4.3 仪表盘            │ 聚会信息/参与者/推荐卡片/投票/地图(<map>)/出发操作/消息流/轮询同步 │ 完整流程通过             │
 ├───────────────────────┼────────────────────────────────────────────────────────────────────┼──────────────────────────┤
 │ 4.4 我的聚会+个人中心 │ 聚会列表、个人信息                                                 │ 页面正常                 │
 ├───────────────────────┼────────────────────────────────────────────────────────────────────┼──────────────────────────┤
 │ 4.5 分享+订阅消息     │ 小程序卡片分享、订阅消息授权、后端对接微信推送                     │ 分享卡片正常、消息可接收 │
 └───────────────────────┴────────────────────────────────────────────────────────────────────┴──────────────────────────┘
 Phase 4 总验证： 真机调试（iOS + Android）+ Web 创建→小程序加入（跨端验证）

 ---
 Phase 5: 打磨 + 部署（3-4 天）
 ┌──────────────────┬──────────────────────────────────────────────────────────┬──────────────────┐
 │       Task       │                           内容                           │     验证标准     │
 ├──────────────────┼──────────────────────────────────────────────────────────┼──────────────────┤
 │ 5.1 两端对齐测试 │ Web↔小程序跨端流程、身份互通、投票同步                   │ 所有跨端场景通过 │
 ├──────────────────┼──────────────────────────────────────────────────────────┼──────────────────┤
 │ 5.2 体验打磨     │ 加载态/骨架屏/错误提示/动画/弱网重试/空状态              │ 体验流畅         │
 ├──────────────────┼──────────────────────────────────────────────────────────┼──────────────────┤
 │ 5.3 部署上线     │ Vercel 部署（Web+API）、环境变量、域名 HTTPS、小程序提审 │ 线上可访问       │
 ├──────────────────┼──────────────────────────────────────────────────────────┼──────────────────┤
 │ 5.4 文档收尾     │ README/API 文档/部署文档/changelog 最终版                │ 文档完整         │
 └──────────────────┴──────────────────────────────────────────────────────────┴──────────────────┘
 ---
 七、工作量总估算
 ┌─────────┬─────────────────┬───────────┬──────────┐
 │  Phase  │      内容       │   预估    │   累计   │
 ├─────────┼─────────────────┼───────────┼──────────┤
 │ Phase 1 │ 基础设施 + 文档 │ 2 天      │ 2 天     │
 ├─────────┼─────────────────┼───────────┼──────────┤
 │ Phase 2 │ 后端核心        │ 4-5 天    │ 6-7 天   │
 ├─────────┼─────────────────┼───────────┼──────────┤
 │ Phase 3 │ Web 前端        │ 5-6 天    │ 11-13 天 │
 ├─────────┼─────────────────┼───────────┼──────────┤
 │ Phase 4 │ 微信小程序      │ 5-6 天    │ 16-19 天 │
 ├─────────┼─────────────────┼───────────┼──────────┤
 │ Phase 5 │ 打磨 + 部署     │ 3-4 天    │ 19-23 天 │
 ├─────────┼─────────────────┼───────────┼──────────┤
 │ 总计    │                 │ 约 4-5 周 │          │
 └─────────┴─────────────────┴───────────┴──────────┘
 ---
 八、关键风险与前置动作
 ┌─────────────────────┬─────────────────────┬─────────────────────────────────────┬────────────┐
 │        风险         │        影响         │                应对                 │    何时    │
 ├─────────────────────┼─────────────────────┼─────────────────────────────────────┼────────────┤
 │ 无小程序账号        │ Phase 4 无法开始    │ 立即注册（建议企业/个体工商户主体） │ 立即       │
 ├─────────────────────┼─────────────────────┼─────────────────────────────────────┼────────────┤
 │ 无 ICP 备案域名     │ 小程序无法上线      │ 启动备案（约 1-3 周）               │ 立即       │
 ├─────────────────────┼─────────────────────┼─────────────────────────────────────┼────────────┤
 │ 高德 API 个人版配额 │ 5000 次/天不够      │ 升级企业认证（免费 30 万次/天）     │ Phase 2 前 │
 ├─────────────────────┼─────────────────────┼─────────────────────────────────────┼────────────┤
 │ Supabase 免费版限制 │ 500MB 存储、50K MAU │ MVP 够用，按需升级 $25/月           │ 监控       │
 ├─────────────────────┼─────────────────────┼─────────────────────────────────────┼────────────┤
 │ 微信扫码登录（Web） │ 需微信开放平台认证  │ Phase 3 先做游客登录，扫码后续加    │ Phase 3    │
 └─────────────────────┴─────────────────────┴─────────────────────────────────────┴────────────┘
 ---
 九、设计系统规范（从设计稿提取）
 ┌──────────┬─────────────────────────────────────┐
 │   维度   │                规范                 │
 ├──────────┼─────────────────────────────────────┤
 │ 主色     │ #f2930d（活力橙）                   │
 ├──────────┼─────────────────────────────────────┤
 │ 辅色     │ #0d94f2（蓝）+ teal-500 系列        │
 ├──────────┼─────────────────────────────────────┤
 │ 成功     │ teal-500 #14b8a6                    │
 ├──────────┼─────────────────────────────────────┤
 │ 警告     │ primary #f2930d                     │
 ├──────────┼─────────────────────────────────────┤
 │ 危险     │ red-500                             │
 ├──────────┼─────────────────────────────────────┤
 │ 背景     │ 亮 #f8f7f5 / 暗 #221b10             │
 ├──────────┼─────────────────────────────────────┤
 │ 卡片     │ 亮 #ffffff / 暗 #2d2418             │
 ├──────────┼─────────────────────────────────────┤
 │ 字体     │ Plus Jakarta Sans                   │
 ├──────────┼─────────────────────────────────────┤
 │ 图标     │ Material Icons Round                │
 ├──────────┼─────────────────────────────────────┤
 │ 圆角     │ 8px / 16px / 24px / 32px            │
 ├──────────┼─────────────────────────────────────┤
 │ 阴影     │ 多层次（sm → xl），hover 加深       │
 ├──────────┼─────────────────────────────────────┤
 │ 动效     │ hover 上浮、pulse 呼吸、bounce 弹跳 │
 ├──────────┼─────────────────────────────────────┤
 │ 暗色模式 │ 完整支持，stone 暖色暗色调          │
 └──────────┴─────────────────────────────────────┘
 ---
 十、执行原则

 1. 每个 Phase 独立可测试 — 上一个 Phase 测试全通过才开始下一个
 2. TDD 驱动 — 后端 API 先写测试再写实现
 3. 共享优先 — 类型/常量/工具先写 shared 包
 4. 设计稿驱动 — UI 严格参考色彩/字体/圆角/动效规范
 5. 不过度设计 — WebSocket、APP 留接口但不提前实现
 6. 小程序账号和域名备案立即启动 — 不要等到 Phase 4 才发现卡住

 ---
 十一、Phase 1 首个执行动作

 1. 重命名 screenshot-20260210-231213.png → assets/logo.png
 2. 创建完整目录结构
 3. 初始化 pnpm workspace + TypeScript
 4. 创建 Supabase 项目（supabase.com）
 5. 从原项目复制设计稿到 design/
 6. 创建所有文档骨架（PRD/architecture/design-system/api-spec）
 7. 搭建 shared 包 + 单元测试
 8. 验证 monorepo 构建链路